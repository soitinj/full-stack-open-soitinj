---
import Layout from '../layouts/Layout.astro'
import ConfettiButton from '../components/ConfettiButton.astro'
import UsernameHeader from '../components/UsernameHeader.jsx'
import 'bootstrap/dist/css/bootstrap.min.css'
import '../styles/index.css'
import App from '../App'
import { setBlogs } from '../nanostores/blogStore'

const response = await fetch(`http://localhost:3003/api/blogs`)
const blogs = await response.json()
setBlogs(blogs)
const initialBlogs = JSON.stringify(blogs)
---

<Layout title="Sample App">
  <!-- Both UsernameHeader and App are synchronized to Nanostores state -->
  <UsernameHeader client:load></UsernameHeader>
  <App loginPage={false} client:load />
  <ConfettiButton></ConfettiButton>
</Layout>

<script is:inline define:vars={{ initialBlogs }}>
  window.BLOGS_INITIAL_DATA = initialBlogs
</script>